                                                                                                                                                                                                                                                                @model CAB.Models.ExcelDataViewModel

                                                                                                                                                                                                                                                                <style>
                                                                                                                                                                                                                                                                    td, th, thead {
                                                                                                                                                                                                                                                                        border: 2px solid #000000;
                                                                                                                                                                                                                                                                        text-align: left;
                                                                                                                                                                                                                                                                        padding: 8px;
                                                                                                                                                                                                                                                                        border-style: solid;
                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                    tr:nth-child(even) {
                                                                                                                                                                                                                                                                        background-color: #dddddd;
                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                </style>

                                                                                                                                                                                                                                                                <style id="table_style" type="text/css">

                                                                                                                                                                                                                                                                    body {
                                                                                                                                                                                                                                                                        font-family: Arial;
                                                                                                                                                                                                                                                                        font-size: 10pt;
                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                    table {
                                                                                                                                                                                                                                                                        border: 1px solid #ccc;
                                                                                                                                                                                                                                                                        border-collapse: collapse;
                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                        table th {
                                                                                                                                                                                                                                                                            background-color: #F7F7F7;
                                                                                                                                                                                                                                                                            color: #333;
                                                                                                                                                                                                                                                                            font-weight: bold;
                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                        table th, table td {
                                                                                                                                                                                                                                                                            padding: 5px;
                                                                                                                                                                                                                                                                            border: 1px solid #000000;
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                </style>

                                                                                                                                                                                                                                                                <script src="~/assets/js/jquery.min.js"></script>

                                                                                                                                                                                                                                                                <script>
                                                                                                                                                                                                                                                                    $(document).ready(function () {
                                                                                                                                                                                                                                                                        $('#data').after('<div id="nav"></div>');
                                                                                                                                                                                                                                                                        var rowsShown = 500;
                                                                                                                                                                                                                                                                        var rowsTotal = $('#data tbody tr').length;
                                                                                                                                                                                                                                                                        var numPages = rowsTotal / rowsShown;
                                                                                                                                                                                                                                                                        for (i = 0; i < numPages; i++) {
                                                                                                                                                                                                                                                                            var pageNum = i + 1;
                                                                                                                                                                                                                                                                            $('#nav').append('<a href="#" rel="' + i + '">' + pageNum + '</a> ');
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                        $('#data tbody tr').hide();
                                                                                                                                                                                                                                                                        $('#data tbody tr').slice(0, rowsShown).show();
                                                                                                                                                                                                                                                                        $('#nav a:first').addClass('active');
                                                                                                                                                                                                                                                                        $('#nav a').bind('click', function () {
                                                                                                                                                                                                                                                                            $('#nav a').removeClass('active');
                                                                                                                                                                                                                                                                            $(this).addClass('active');
                                                                                                                                                                                                                                                                            var currPage = $(this).attr('rel');
                                                                                                                                                                                                                                                                            var startItem = currPage * rowsShown;
                                                                                                                                                                                                                                                                            var endItem = startItem + rowsShown;
                                                                                                                                                                                                                                                                            $('#data tbody tr').css('opacity', '0.0').hide().slice(startItem, endItem).
                                                                                                                                                                                                                                                                                css('display', 'table-row').animate({ opacity: 1 }, 300);
                                                                                                                                                                                                                                                                        });
                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                </script>

                                                                                                                                                                                                                                                                <div class="page-content">
                                                                                                                                                                                                                                                                    <!--breadcrumb-->
                                                                                                                                                                                                                                                                    <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
                                                                                                                                                                                                                                                                        <div class="breadcrumb-title pe-3">CAB</div>
                                                                                                                                                                                                                                                                        <nav aria-label="breadcrumb">
                                                                                                                                                                                                                                                                            <ol class="breadcrumb mb-0 p-0">
                                                                                                                                                                                                                                                                                <li class="breadcrumb-item">
                                                                                                                                                                                                                                                                                    <a href="javascript:;"><a class="nav-link" asp-area="" asp-controller="Home" asp-action="Index"><i class="bx bx-home-alt" style="font-size: 30px;"></i></a></a>
                                                                                                                                                                                                                                                                                </li>
                                                                                                                                                                                                                                                                            </ol>
                                                                                                                                                                                                                                                                        </nav>


                                                                                                                                                                                                                                                                    </div>

                                                                                                                                                                                                                                                                    <div class="card border-top border-0 border-4 border-danger">
                                                                                                                                                                                                                                                                        <div class="card" style="margin-left:0px;">

                                                                                                                                                                                                                                                                            <div class="d-lg-flex align-items-center mb-4 gap-3">
               
                                                                                                                                                                                                                                                                            </div>





                                                                                                                                                                                                                                                                            <div id="dvContentsa1" style="border: 1px solid black; padding: 5px;">

                                                                                                                                                                                                                                                                                <h4 aria-current="page" style="text-align: center;"><b><u>Process Data</u></b></h4>

                                                                                                                                                                                                                                                                                <form method="post" enctype="multipart/form-data" id="processf">

                                                                                                                                                                                                                                                                                    <input type="text" id="id" name="id" value="@ViewBag.ExcelFileId" style="display:none" />


                                                                                                                                                                                                                                                                                    <table style="border: 1px solid black; padding: 5px;" id="data" class="table-bordered table   mb-0 " cellpadding="0" cellspacing="0" align="center" width="100%">



                                                                                                                                                                                                                                                                                        <thead class="bg-primary" align="center">
                                                                                                                                                                                                                                                                                            <tr>
                                                                                                                                                                                                                                                                                                <th>
                                  
                                                                                                                                                                                                                                                                                                    <input type='checkbox' id="checkAll" name='checkbox'>
                                                                                                                                                                                                                                                                                                    <span class="sub"> Select </span>
                                                                                                                                                                                                                                                                                                </th>
                                                                                                                                                                                                                                                                                                <th>ArmyNo</th>
                                                                                                                                                                                                                                                                                                <th>Name</th>
                                                                                                                                                                                                                                                                                                <th>Complaint_Type</th>
                                                                                                                                                                                                                                                                                                <th>Rank</th>
                                                                                                                                                                                                                                                                                                <th>Subject</th>
                                                                                                                                                                                                                                                                                                <th>Dt_Of_Complaint</th>
                                                                                                                                                                                                                                                                                                <th>Recd_Date_Cab </th>
                                                                                                                                                                                                                                                                                                <th>Regt</th>
                                                                                                                                                                                                                                                                                                <th>Case_Status</th>
                                                                                                                                                                                                                                                                                            </tr>
                                                                                                                                                                                                                                                                                        </thead>
                                                                                                                                                                                                                                                                                        @*<tbody>
                                                                                                                                                                                                                                                                                            @if (Model != null && Model.ExcelDatas != null)
                                                                                                                                                                                                                                                                                            {
                                                                                                                                                                                                                                                                                                for (int i = 0; i < Model.ExcelDatas.Count; i++)
                                                                                                                                                                                                                                                                                                {
                                   

                                                                                                                                                                                                                                                                                                    <tr>
                                                                                                                                                                                                                                                                                                        <td>
                                                                                                                                                                                                                                                                                                            @Html.CheckBoxFor(modelItem => Model.ExcelDatas[i].Checked) &nbsp;&nbsp;
                                                                                                                                                                                                                                                                                                        </td>
                                                                                                                                                                                                                                                                                                        <td>@Html.DisplayFor(modelItem => Model.ExcelDatas[i].ArmyNo)</td>
                                                                                                                                                                                                                                                                                                        <td>@Html.DisplayFor(modelItem => Model.ExcelDatas[i].Name)</td>
                                                                                                                                                                                                                                                                                                        <td> @Html.DisplayFor(modelItem => Model.ExcelDatas[i].Complaint_Type)</td> 
                                                                                                                                                                                                                                                                                                        <td> @Html.DisplayFor(modelItem => Model.ExcelDatas[i].Rank) </td>
                                                                                                                                                                                                                                                                                                        <td>@Html.DisplayFor(modelItem => Model.ExcelDatas[i].Subject)</td> 
                                                                                                                                                                                                                                                                                                        <td>@Html.DisplayFor(modelItem => Model.ExcelDatas[i].Dt_Of_Complaint)</td> 
                                                                                                                                                                                                                                                                                                        <td>@Html.DisplayFor(modelItem => Model.ExcelDatas[i].Recd_Date_Cab)</td>
                                                                                                                                                                                                                                                                                                        <td> @Html.DisplayFor(modelItem => Model.ExcelDatas[i].Regt) </td>
                                                                                                                                                                                                                                                                                                        <td> @Html.DisplayFor(modelItem => Model.ExcelDatas[i].Case_Status) </td> 
                                                                                                                                                                                                                                                                                                    </tr>
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                        </tbody>*@
                                                                                                                                                                                                                                                                                    </table>
                                                                                                                                                                                                                                                                                    <br /><br />
                                                                                                                                                                                                                                                                                    <div class="form-group">
                                                                                                                                                                                                                                                                                        <input type="submit" value="Submit" class="btn btn-danger px-5" />
                                                                                                                                                                                                                                                                                        <span>  <a asp-action="uploadFile" asp-controller="ImportData" class="btn btn-primary px-5">Back</a></span>
                                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                                </form>
                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                        </div>
                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                    <script type="text/javascript">




                                                                                                                                                                                                                                                                        $("#checkAll").click(function () {
                                                                                                                                                                                                                                                                            $('input:checkbox').not(this).prop('checked', this.checked);
                                                                                                                                                                                                                                                                        });





                                                                                                                                                                                                                                                                        $("#processf").submit(function (e) {
                                                                                                                                                                                                                                                                            e.preventDefault();
                                                                                                                                                                                                                                                                            var url = "@Url.Action("ProcessDataCnf1","ProcessData")";
                                                                                                                                                                                                                                                                            var checkIndex = new Array();

                                                                                                                                                                                                                                                                            $('#tbdata > tbody  > tr').each(function (index, tr) {
                                                                                                                                                                                                                                                                                var val = $(this).children('td').children('input').eq(0).is(':checked');
        
                                                                                                                                                                                                                                                                                if (val == true) {
                                                                                                                                                                                                                                                                                    checkIndex.push(index);
                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                            var arr = JSON.parse('@Html.Raw(Json.Serialize(Model.tbl_CabData))');
         
                                                                                                                                                                                                                                                                            var excelid = $("#id").val();
                                                                                                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                                                                                                type: "POST",
                                                                                                                                                                                                                                                                                data: { "dt": JSON.stringify(arr), "indexs": checkIndex, "id": excelid },
                                                                                                                                                                                                                                                                                url: url,
                                                                                                                                                                                                                                                                                success: function (res) {
                                                                                                                                                                                                                                                                                    alert(res);
                                                                                                                                                                                                                                                                                    location.href = "/ImportData/uploadFile";
                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                            }).done(function (res) {

                                                                                                                                                                                                                                                                            });


                                                                                                                                                                                                                                                                        });


                                                                                                                                                                                                                                                                    </script>


                                                                                                                                                                                                                                                                    </div>
