                                                                                                                                                                                                                                                            @model Upload_dtl

                                                                                                                                                                                                                                                            @{

                                                                                                                                                                                                                                                                var message1 = TempData["message"] as string;
                                                                                                                                                                                                                                                                var message2 = TempData["Message1"] as string;
   
                                                                                                                                                                                                                                                            }



                                                                                                                                                                                                                                                            <div class="masthead backcolor">
                                                                                                                                                                                                                                                                <h3 class="text-white text-center p-2">
                                                                                                                                                                                                                                                                        Backup File Uploading Utility

                                                                                                                                                                                                                                                                    </h3>
                                                                                                                                                                                                                                                                </div>

                                                                                                                                                                                                                                                                <div class="row align-items-center mt-5">
                                                                                                                                                                                                                                                                    <div class="col-md-4">
                                                                                                                                                                                                                                                                        </div>
                                                                                                                                                                                                                                                                    <div class="col-md-4 borderdiv">
                                                                                                                                                                                                                                                                       @* <h3>Backup File Uploading Utility</h3>*@
                                                                                                                                                                                                                                                                        <div class="form-body ">
                                                                                                                                                                                                                                                                            <div class="row">

                                                                                                                                                                                                                                                                            <div class="card border-top border-0 mt-2 m-0">
                                                                                                                                                                                                                                                                                    <div class="card-body " style="padding:1px;" >
                                                                                                                                                                                                                                                                                        <div class="card-title d-flex align-items-center">

                              
                                                                                                                                                                                                                                                                                            <h5 class="mb-0 text-danger">Upload Data</h5>

                                                                                                                                                                                                                                                                                        </div> @*class="needs-validation"*@
                                                                                                                                                                                                                                                                                        <form enctype="multipart/form-data" method="post"
                                                                                                                                                                                                                                                                                              asp-action="uploadFile" asp-controller="ImportData">


                                
                                                                                                                                                                                                                                                                                            <div class="form-group">
                                                                                                                                                                                                                                                                                                <label>
                                                                                                                                                                                                                                                                                                    <b>Select File For Upload </b><p>*Only Excel File Format is Permitted</p>
                                                                                                                                                                                                                                                                                                </label>
                                                                                                                                                                                                                                                                                                <div class="d-flex">
                                                                                                                                                                                                                                                                                                <input type="file" id="file" required name="postedFiles" accept=".xls,.xlsx"
                                                                                                                                                                                                                                                                                                       onchange="checkfile(this);" aria-label="file example" />
                                      
                                                                                                                                                                                                                                                                                                    <input type="submit" class="btn btn-success" value="UPLOAD" />
                                        

                                                                                                                                                                                                                                                                                                </div>
                                   
                                                                                                                                                                                                                                                                                            </div>
                                   
                               
                                                                                                                                                                                                                                                                                        </form>
                           
                                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                            </div>

                                                                                                                                                                                                                                                                        </div>
                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                    <div class="col-md-4">
                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                    <div class="col-md-3">
                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                    <div class="col-md-6 mt-5">
                                                                                                                                                                                                                                                                        <div class="form-body">
                                                                                                                                                                                                                                                                            <div class="row">
                                                                                                                                                                                                                                                                                <div class="card border-top border-0">
                                                                                                                                                                                                                                                                                    <div class="card-body p-1">
                                                                                                                                                                                                                                                                                        <div class="card-title d-flex align-items-center">
                                
                                                                                                                                                                                                                                                                                        <h5 class="danger">@TempData["ss"]</h5>
                                                                                                                                                                                                                                                                                        </div>
                                                                                                                                                                                                                                                                                        <div class="table-responsive">
                                                                                                                                                                                                                                                                                            <table id="demoGrid" class="table table-bordered table-striped ">
                                                                                                                                                                                                                                                                                                <thead>
                                                                                                                                                                                                                                                                                                    <tr class="table-secondary text-center">
                                                                                                                                                                                                                                                                                                    <th class="text-center">
                                                                                                                                                                                                                                                                                                        <div class="text-center">S/No</div>
                                                                                                                                                                                                                                                                                                    </th>
                                                                                                                                                                                                                                                                                                        <th class="text-center">
                                                                                                                                                                                                                                                                                                        <div class="text-center">File Name</div>
                                                                                                                                                                                                                                                                                                        </th>
                                                                                                                                                                                                                                                                                                        <th class="text-center">
                                                                                                                                                                                                                                                                                                            <div class="text-center">Uploaded Date</div>
                                                                                                                                                                                                                                                                                                        </th>
                                                                                                                                                                                                                                                                                                       @* <th class="text-center">
                                                                                                                                                                                                                                                                                                            <div class="text-center">Status</div>
                                                                                                                                                                                                                                                                                                        </th>*@
                                                                                                                                                                                                                                                                                                        <th class="text-center">
                                                                                                                                                                                                                                                                                                            <div class="text-center">Action</div>
                                                                                                                                                                                                                                                                                                        </th>
                                                                                                                                                                                                                                                                                                    </tr>
                                                                                                                                                                                                                                                                                                </thead>
                                                                                                                                                                                                                                                                                                <tbody>
                                                                                                                                                                                                                                                                                                @{
                                                                                                                                                                                                                                                                                                    var i = 0;
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                   @foreach (var item in (IEnumerable<CAB.Models.Upload_dtl>)@ViewBag.GetAll)
                                                                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                                                                    i++;
                                                                                                                                                                                                                                                                                                    <tr class="table-secondary text-center">
                                                                                                                                                                                                                                                                                                        <td class="table-secondary text-center">
                                                                                                                                                                                                                                                                                                            @i
                                                                                                                                                                                                                                                                                                            </td>
                                                                                                                                                                                                                                                                                                            <td class="table-secondary text-center">
                                                                                                                                                                                                                                                                                                                @Html.DisplayFor(modelItem => item.FileName)
                                                                                                                                                                                                                                                                                                            </td>
                                                                                                                                                                                                                                                                                                            <td class="text-center">
                                                                                                                                                                                                                                                                                                                @Html.DisplayFor(modelItem => item.uploaddt)
                                                                                                                                                                                                                                                                                                            </td>
                                                                                                                                                                                                                                                                                                           @* <td class="text-center">
                                                                                                                                                                                                                                                                                                                @Html.DisplayFor(modelItem => item.UploadedBy)
                                                                                                                                                                                                                                                                                                            </td>*@
                                                                                                                                                                                                                                                                                                            <td class="text-center">
                                                                                                                                                                                                                                                                                                                @*   @item.ProcessData*@
                                                                                                                                                                                                                                                                                                                <div id="hideButton">
                                                                                                                                                                                                                                                                                                                    <a asp-action="ProcessDataCnf" class="btn btn-primary btn mb-4"
                                                                                                                                                                                                                                                                                                                   asp-controller="ProcessData"
                                                                                                                                                                                                                                                                                                                   asp-route-Id="@item.Id" onclick="removeButton()"
                                                                                                                                                                                                                                                                                                                   asp-route-FileName="@item.FileName">Process</a>
                                                                                                                                                                                                                                                                                                                </div>


                                                                                                                                                                                                                                                                                                                <button type="submit" class="btn btn-danger btn-sm d-none"
                                                                                                                                                                                                                                                                                                                    onclick="functionConfirm1(@item.Id)">
                                                                                                                                                                                                                                                                                                                    Remove
                                                                                                                                                                                                                                                                                                                </button>
                                                                                                                                                                                                                                                                                                            </td>
                                                                                                                                                                                                                                                                                                        </tr>
                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                </tbody>
                                                                                                                                                                                                                                                                                            </table>
                               
                                                                                                                                                                                                                                                                                            <script>
                                                                                                                                                                                                                                                                                                function functionConfirm() {

                                                                                                                                                                                                                                                                                                    Swal.fire({
                                                                                                                                                                                                                                                                                                        title: 'Are you sure?',
                                                                                                                                                                                                                                                                                                        text: "Do you want to Upload!",
                                                                                                                                                                                                                                                                                                        icon: 'warning',
                                                                                                                                                                                                                                                                                                        showCancelButton: true,
                                                                                                                                                                                                                                                                                                        confirmButtonText: 'Yes, Upload it!'
                                                                                                                                                                                                                                                                                                    }).then((result) => {
                                                                                                                                                                                                                                                                                                        if (result.isConfirmed) {
                                                                                                                                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                                                                                                                                //debugger;
                                                                                                                                                                                                                                                                                                                url: '/ImportData/uploadFile',
                                                                                                                                                                                                                                                                                                                type: 'POST',
                                                                                                                                                                                                                                                                                                                success: function (response) {
                                                                                                                                                                                                                                                                                                                    //debugger;
                                                                                                                                                                                                                                                                                                                    console.log(response);
                                                                                                                                                                                                                                                                                                                    if (response) {  // check if data is defined
                                                                                                                                                                                                                                                                                                                        if (response != null) {
                                                                                                                                                                                                                                                                                                                            if (response == 1) {
                                                                                                                                                                                                                                                                                                                                Swal.fire({
                                                                                                                                                                                                                                                                                                                                    position: 'top-end',
                                                                                                                                                                                                                                                                                                                                    icon: 'success',
                                                                                                                                                                                                                                                                                                                                    title: 'Record Uploaded successfully',
                                                                                                                                                                                                                                                                                                                                    showConfirmButton: false,
                                                                                                                                                                                                                                                                                                                                    timer: 1500
                                                                                                                                                                                                                                                                                                                                })

                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                    })

                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                            </script>

                                                                                                                                                                                                                                                                                            <script>

                                                                                                                                                                                                                                                                                                function functionConfirm1(Id) {

                                                                                                                                                                                                                                                                                                    Swal.fire
                                                                                                                                                                                                                                                                                                        ({
                                                                                                                                                                                                                                                                                                            title: 'Are you sure?',
                                                                                                                                                                                                                                                                                                            text: "Do you want to delete!",
                                                                                                                                                                                                                                                                                                            icon: 'warning',
                                                                                                                                                                                                                                                                                                            showCancelButton: true,
                                                                                                                                                                                                                                                                                                            confirmButtonText: 'Yes, Delete it!'
                                                                                                                                                                                                                                                                                                        }).then((result) => {
                                                                                                                                                                                                                                                                                                            if (result.isConfirmed) {

                                                                                                                                                                                                                                                                                                                $.ajax({
                                                                                                                                                                                                                                                                                                                    url: '/ImportData/Delete',
                                                                                                                                                                                                                                                                                                                    type: 'POST',
                                                                                                                                                                                                                                                                                                                    data: { "id": Id }, //get the search string
                                                                                                                                                                                                                                                                                                                    success: function (response) {
                                                                                                                                                                                                                                                                                                                        console.log(response);
                                                                                                                                                                                                                                                                                                                        if (response) {  // check if data is defined
                                                                                                                                                                                                                                                                                                                            if (response != null) {
                                                                                                                                                                                                                                                                                                                                if (response == 1) {
                                                                                                                                                                                                                                                                                                                                    Swal.fire({
                                                                                                                                                                                                                                                                                                                                        position: 'top-end',
                                                                                                                                                                                                                                                                                                                                        icon: 'success',
                                                                                                                                                                                                                                                                                                                                        title: 'Record Deleted successfully',
                                                                                                                                                                                                                                                                                                                                        showConfirmButton: false,
                                                                                                                                                                                                                                                                                                                                        timer: 1500
                                                                                                                                                                                                                                                                                                                                    })

                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                        window.location.href = '@Url.Action("uploadFile", "ImportData")';
                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                        })

                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                function functionConfirm2() {

                                                                                                                                                                                                                                                                                                    Swal.fire({
                                                                                                                                                                                                                                                                                                        title: "are you sure You Want To Submit ?",
                                                                                                                                                                                                                                                                                                        showCancelButton: true,
                                                                                                                                                                                                                                                                                                        timer: 3000,
                                                                                                                                                                                                                                                                                                        confirmButtonText: "Confirm",
                                                                                                                                                                                                                                                                                                        confirmButtonColor: "#00ff99",
                                                                                                                                                                                                                                                                                                        cancelButtonColor: "#ff0099",


                                                                                                                                                                                                                                                                                                    });


                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            </script>
                                                                                                                                                                                                                                                                                            <script type="text/javascript" language="javascript">

                                                                                                                                                                                                                                                                                                function functionConfirm3() {
                                                                                                                                                                                                                                                                                                    Swal.fire({
                                                                                                                                                                                                                                                                                                        title: 'Are You Sure You want To Submit ?',
                                                                                                                                                                                                                                                                                                        showDenyButton: true,
                                                                                                                                                                                                                                                                                                        showCancelButton: true,
                                                                                                                                                                                                                                                                                                        confirmButtonText: 'Yes',
                                                                                                                                                                                                                                                                                                        denyButtonText: `No`,
                                                                                                                                                                                                                                                                                                    }).then((result) => {
                                                                                                                                                                                                                                                                                                        /* Read more about isConfirmed, isDenied below */
                                                                                                                                                                                                                                                                                                        if (result.isConfirmed) {
                                                                                                                                                                                                                                                                                                            Swal.fire('Saved!', '', 'success')
                                                                                                                                                                                                                                                                                                        } else if (result.isDenied) {
                                                                                                                                                                                                                                                                                                            Swal.fire('Changes are not saved', '', 'info')
                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                    })
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            </script>
                                                                                                                                                                                                                                                                                            <script src="~/js/jquery.min.js"></script>
                                                                                                                                                                                                                                                                                        </div>
                                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                        </div>
                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                    <div class="col-md-3">
                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                </div>

                                                                                                                                                                                                                                                            <input type="hidden" value="@message1" id="hdnMessage" />
                                                                                                                                                                                                                                                            <input type="hidden" value="@message2" id="hdnMessage2" />



                                                                                                                                                                                                                                                                <script type="text/javascript" language="javascript">
                                                                                                                                                                                                                                                                    function checkfile(sender) {
                                                                                                                                                                                                                                                                        var validExts = new Array(".xlsx", ".xls");
                                                                                                                                                                                                                                                                        var fileExt = sender.value;
                                                                                                                                                                                                                                                                        fileExt = fileExt.substring(fileExt.lastIndexOf('.'));
                                                                                                                                                                                                                                                                        if (validExts.indexOf(fileExt) < 0) {

                                                                                                                                                                                                                                                                            Swal.fire('Invalid file selected, Please Select Excel File !')
       
                                                                                                                                                                                                                                                                            return false;
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                        else return true;
                                                                                                                                                                                                                                                                    }
  
                                                                                                                                                                                                                                                                    $(document).ready(function () {
                                                                                                                                                                                                                                                                        if ($("#hdnMessage").val() != "") {
                                                                                                                                                                                                                                                                            var msg = $("#hdnMessage").val();
                                                                                                                                                                                                                                                                            alert(msg, "Good job!", 'msg', "success");
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                        if ($("#hdnMessage2").val() != "") {
                                                                                                                                                                                                                                                                            var msg2 = $("#hdnMessage2").val();
                                                                                                                                                                                                                                                                            alert(msg2, "Good job!", 'msg', "success");
                                                                                                                                                                                                                                                                        }


                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                    $(document).ready(function () {
                                                                                                                                                                                                                                                                        $("#btnProcess").click(function () {
                                                                                                                                                                                                                                                                            toggleSideBar(this);
                                                                                                                                                                                                                                                                        });
                                                                                                                                                                                                                                                                    });


    
                                                                                                                                                                                                                                                                    //window.onload = function removeButton()() {
                                                                                                                                                                                                                                                                    //    var button = document.getElementById("hideButton");
                                                                                                                                                                                                                                                                    //    button.remove();
                                                                                                                                                                                                                                                                    //    alert("done");
                                                                                                                                                                                                                                                                    //}
                                                                                                                                                                                                                                                                    function removeButton() {
                                                                                                                                                                                                                                                                        var button = document.getElementById("hideButton");
                                                                                                                                                                                                                                                                        button.remove();
                                                                                                                                                                                                                                                                    alert("done");
                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                </script>



                                                                                                                                                                                                                                                            @*
                                                                                                                                                                                                                                                                <script type="text/javascript">
                                                                                                                                                                                                                                                                    function disableButton(btn) {
                                                                                                                                                                                                                                                                        document.getElementById(btn.id).disabled = true;
                                                                                                                                                                                                                                                                        var msg2 = $("#hdnMessage2").val();
                                                                                                                                                                                                                                                                        alert("");
                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                </script>
                                                                                                                                                                                                                                                            *@

